<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Ð¤Ð¾Ñ‚Ð¾</title>
</head>
<body>

<video id="video" autoplay playsinline></video><br>
<button onclick="photo()">ðŸ“¸ Ð¤Ð¾Ñ‚Ð¾</button><br><br>
<canvas id="canvas"></canvas><br><br>

<input id="name" placeholder="Ð˜Ð¼Ñ"><br>
<textarea id="comment" placeholder="ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹"></textarea><br><br>

<button onclick="send()">ðŸ“¤ ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ</button>

<script>
const URL = 'https://script.google.com/macros/s/AKfycbzFESSq5wXHO34-31ezqsuScbjiG7mtEgTAE48Xj8LgJIItDyBt-OFPCrRVJDtLnVJl7g/exec';

let stream;
navigator.mediaDevices.getUserMedia({video:true})
.then(s => {
  stream = s;
  video.srcObject = s;
});

function photo(){
  canvas.width = video.videoWidth;
  canvas.height = video.videoHeight;
  canvas.getContext('2d').drawImage(video,0,0);
}

function send(){
  const fd = new FormData();
  fd.append('photo', canvas.toDataURL('image/jpeg',0.9));
  fd.append('name', name.value);
  fd.append('comment', comment.value);

  fetch(URL,{
    method:'POST',
    body:fd
  })
  .then(r=>r.text())
  .then(t=>alert(t));
}
</script>

</body>
</html>
